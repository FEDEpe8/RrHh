<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal RRHH Chascom√∫s</title>
    <meta name="theme-color" content="#004a7c">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/jpeg" href="logo.jpg">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary-blue: #004a7c; --accent-green: #97d700; --bg-light: #f4f7f6; }
        body { font-family: 'Roboto', sans-serif; background-color: var(--bg-light); margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        header { background: var(--primary-blue); color: white; padding: 10px 15px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 10; }
        .header-content { display: flex; align-items: center; }
        .header-logo { height: 40px; margin-right: 10px; border-radius: 4px; }
        .header-info h1 { font-size: 0.9rem; margin: 0; }
        .btn-logout { background: rgba(255,255,255,0.2); border: none; color: white; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 0.7rem; }
        
        .chat-container { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 12px; padding-bottom: 20px; }
        .message-row { display: flex; flex-direction: column; width: 100%; }
        .message { max-width: 85%; padding: 12px 15px; border-radius: 15px; font-size: 0.95rem; line-height: 1.4; }
        .bot { background: white; align-self: flex-start; border-bottom-left-radius: 2px; border: 1px solid #ddd; }
        .user { background: var(--primary-blue); color: white; align-self: flex-end; border-bottom-right-radius: 2px; }

        .options-container { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; }
        .option-button { background: white; border: 1.5px solid var(--primary-blue); color: var(--primary-blue); padding: 8px 14px; border-radius: 20px; cursor: pointer; font-weight: 500; font-size: 0.85rem; }
        
        .form-card { background: #eef6fc; padding: 15px; border-radius: 12px; border-left: 4px solid var(--primary-blue); width: 90%; margin-top: 5px; }
        .form-card label { display: block; font-size: 0.7rem; font-weight: bold; color: var(--primary-blue); margin-bottom: 2px; }
        .form-card input, .form-card select { width: 100%; padding: 8px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 5px; }
        
        .form-actions { display: flex; gap: 5px; }
        .btn-submit { flex: 2; background: #27ae60; color: white; border: none; padding: 10px; border-radius: 5px; font-weight: bold; cursor: pointer; }
        .btn-cancel { flex: 1; background: #95a5a6; color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; }

        .input-area { padding: 10px; background: white; display: flex; gap: 8px; border-top: 1px solid #eee; }
        #userInput { flex: 1; padding: 10px 15px; border: 1px solid #ddd; border-radius: 20px; outline: none; }
        #sendButton { background: var(--accent-green); border: none; padding: 0 15px; border-radius: 20px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

    <header>
        <div class="header-content">
            <img src="logo.jpg" alt="Logo" class="header-logo" onerror="this.style.display='none'">
            <div class="header-info"><h1>Portal RRHH Chascom√∫s</h1></div>
        </div>
        <button onclick="clearChat()" class="btn-logout">Cerrar Sesi√≥n</button>
    </header>

    <main id="chatMessages" class="chat-container"></main>

    <footer class="input-area">
        <input type="text" id="userInput" placeholder="Escribe aqu√≠..." autocomplete="off">
        <button id="sendButton">Enviar</button>
    </footer>

    <script>
        const WHATSAPP_RRHH = "5492241538198";
        
        const menus = {
            main: { id: 'main', title: '¬øQu√© tr√°mite deseas realizar?', options: [
                { id: 'recibos', label: 'üìÑ Recibos de Sueldo' },
                { id: 'licencias', label: 'üìù Licencias y Art√≠culos' },
                { id: 'medicina', label: 'üè• Medicina Laboral' },
                { id: 'faq', label: '‚ùì Preguntas Frecuentes' },
                { id: 'contacto', label: 'üë§ Hablar con un Operador', type: 'leaf', apiKey: 'contacto_humano' }
            ]},
            licencias: { id: 'licencias', parent: 'main', title: 'Tr√°mites de Licencias:', options: [
                { id: 'form_vacaciones', label: 'üèñÔ∏è Vacaciones', type: 'form', formType: 'vacaciones' },
                { id: 'form_articulos', label: 'üìë Art√≠culos Especiales', type: 'form', formType: 'articulos' },
                { id: 'lic_info', label: '‚ÑπÔ∏è Informaci√≥n de Art√≠culos', type: 'leaf', apiKey: 'info_arts' }
            ]},
            // ... resto de men√∫s (recibos, medicina, faq se mantienen igual)
        };

        // Copiar el resto de los men√∫s de tu versi√≥n anterior aqu√≠ para completar...
        menus.recibos = { id: 'recibos', parent: 'main', title: 'Recibos:', options: [{ id: 'ir_intranet', label: 'üåê Intranet', type: 'leaf', apiKey: 'intranet_link' }, { id: 'error_ingreso', label: 'üîë Ayuda Clave', type: 'leaf', apiKey: 'ayuda_clave' }]};
        menus.medicina = { id: 'medicina', parent: 'main', title: 'Medicina Laboral:', options: [{ id: 'horarios_med', label: '‚è∞ Horarios', type: 'leaf', apiKey: 'med_info' }]};
        menus.faq = { id: 'faq', parent: 'main', title: 'F.A.Q:', options: [{ id: 'faq_vacas', label: 'üìÖ Vacaciones', type: 'leaf', apiKey: 'ans_vacas' }, { id: 'faq_art', label: 'üöë ART', type: 'leaf', apiKey: 'ans_art' }]};

        const responses = {
            'info_arts': `<strong>üìë Art√≠culos Disponibles:</strong><br>‚Ä¢ Art 1: Asuntos Particulares.<br>‚Ä¢ Art 2: Familiar Enfermo.<br>‚Ä¢ Art 3: Donaci√≥n de Sangre.<br>‚Ä¢ Art 4: Fallecimiento Familiar.`,
            'intranet_link': `Acceso: <a href="https://intranet.chascomus.gob.ar/">Intranet Chascom√∫s</a>`,
            'med_info': `Centro C√≠vico: Dorrego esq. Bolivar.`,
            'ans_vacas': `Depende de tu antig√ºedad (14 a 35 d√≠as).`,
            'ans_art': `Llamar a la ART y avisar a RRHH en < 24hs.`,
            'contacto_humano': `WhatsApp: <a href="https://wa.me/${WHATSAPP_RRHH}">Click aqu√≠</a>`
        };

        let userName = localStorage.getItem('hr_user_name') || "";
        let currentPath = ['main'];

        window.onload = () => {
            if (!userName) addBotMessage("Ingres√° Nombre y Legajo para comenzar:");
            else renderMenu();
        };

        function renderMenu() {
            const menu = menus[currentPath[currentPath.length - 1]];
            let opts = [...menu.options];
            if (currentPath.length > 1) opts.push({ id: 'back', label: '‚¨ÖÔ∏è Volver al Men√∫ Principal', type: 'nav' });
            addBotMessage(menu.title, true, opts);
        }

        function handleOption(id, label, type, apiKey, formType) {
            if (id === 'back') { currentPath = ['main']; renderMenu(); return; }
            addUserMessage(label);
            if (type === 'form') renderForm(formType);
            else if (type === 'leaf') { addBotMessage(responses[apiKey]); setTimeout(renderMenu, 1500); }
            else { currentPath.push(id); renderMenu(); }
        }

        function renderForm(type) {
            const formId = `f_${Date.now()}`;
            const isVaca = type === 'vacaciones';
            const html = `
                <div class="form-card" id="${formId}">
                    <strong>${isVaca ? 'üèñÔ∏è Solicitud Vacaciones' : 'üìë Otros Art√≠culos'}</strong>
                    <label>FECHA INICIO</label><input type="date" id="f_date">
                    <label>${isVaca ? 'CANTIDAD D√çAS' : 'SELECCIONAR ART√çCULO'}</label>
                    ${isVaca ? '<input type="number" id="f_val" placeholder="Ej: 14">' : '<select id="f_val"><option>Art 1 (Particulares)</option><option>Art 2 (Familiar)</option><option>Examen/Estudio</option></select>'}
                    <div class="form-actions">
                        <button class="btn-submit" onclick="submitForm('${type}', '${formId}')">ENVIAR</button>
                        <button class="btn-cancel" onclick="cancelForm('${formId}')">CANCELAR</button>
                    </div>
                </div>`;
            addBotMessage("Complet√° los datos:");
            const div = document.createElement('div');
            div.innerHTML = html;
            document.getElementById('chatMessages').appendChild(div);
            scrollChat();
        }

        function cancelForm(id) {
            document.getElementById(id).innerHTML = "<small><i>Formulario cancelado.</i></small>";
            setTimeout(renderMenu, 1000);
        }

        function submitForm(type, formId) {
            const container = document.getElementById(formId);
            const date = container.querySelector('#f_date').value;
            const val = container.querySelector('#f_val').value;
            if(!date || !val) return alert("Faltan datos");
            window.open(`https://wa.me/${WHATSAPP_RRHH}?text=${encodeURIComponent("*SOLICITUD RRHH*\nTipo: "+type+"\nEmpleado: "+userName+"\nFecha: "+date+"\nDetalle: "+val)}`, '_blank');
            container.innerHTML = "<b>‚úÖ Enviado.</b>";
            setTimeout(renderMenu, 2000);
        }

        function displayMessage(role, text, options) {
            const row = document.createElement('div');
            row.className = `message-row`;
            let html = `<div class="message ${role}">${text}</div>`;
            if (options) {
                html += `<div class="options-container">`;
                options.forEach(o => { html += `<button class="option-button" onclick="handleOption('${o.id}','${o.label}','${o.type}','${o.apiKey}','${o.formType}')">${o.label}</button>`; });
                html += `</div>`;
            }
            row.innerHTML = html;
            document.getElementById('chatMessages').appendChild(row);
            scrollChat();
        }

        function addBotMessage(t, s, o) { displayMessage('bot', t, o); }
        function addUserMessage(t) { displayMessage('user', t); }
        function scrollChat() { const c = document.getElementById('chatMessages'); c.scrollTop = c.scrollHeight; }
        function clearChat() { localStorage.clear(); location.reload(); }

        document.getElementById('sendButton').onclick = () => {
            const v = document.getElementById('userInput').value;
            if(!userName && v) { userName = v; localStorage.setItem('hr_user_name', v); renderMenu(); }
            document.getElementById('userInput').value = '';
        };
    </script>
</body>
</html>
