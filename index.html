<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Portal RRHH Chascom√∫s</title>
    <meta name="theme-color" content="#004a7c">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/jpeg" href="logo.jpg">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
   <style>
    :root { --primary-blue: #004a7c; --accent-green: #97d700; --bg-light: #f4f7f6; }
    body { font-family: 'Roboto', sans-serif; background-color: var(--bg-light); margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
    
    header { background: var(--primary-blue); color: white; padding: 10px 15px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 10; }
    .header-content { display: flex; align-items: center; }
    .header-logo { height: 40px; margin-right: 10px; border-radius: 4px; }
    .header-info h1 { font-size: 0.9rem; margin: 0; }
    .btn-logout { background: rgba(255,255,255,0.2); border: none; color: white; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 0.7rem; }
    
    /* Contenedor de chat con espacio extra abajo para que no tape la barra */
    .chat-container { 
        flex: 1; 
        overflow-y: auto; 
        padding: 15px; 
        display: flex; 
        flex-direction: column; 
        gap: 12px; 
        padding-bottom: 100px; /* ESPACIO PARA QUE LOS BOTONES NO QUEDEN ATR√ÅS */
        scroll-behavior: smooth;
    }

    .message-row { display: flex; flex-direction: column; width: 100%; animation: fadeIn 0.3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .message { max-width: 85%; padding: 12px 15px; border-radius: 15px; font-size: 0.95rem; line-height: 1.4; }
    .bot { background: white; align-self: flex-start; border-bottom-left-radius: 2px; border: 1px solid #ddd; color: #333; }
    .user { background: var(--primary-blue); color: white; align-self: flex-end; border-bottom-right-radius: 2px; }

    .options-container { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; padding-bottom: 5px; }
    .option-button { background: white; border: 1.5px solid var(--primary-blue); color: var(--primary-blue); padding: 8px 14px; border-radius: 20px; cursor: pointer; font-weight: 500; font-size: 0.85rem; transition: all 0.2s; }
    .option-button:active { background: var(--primary-blue); color: white; }
    
    /* BARRA FLOTANTE */
    .input-area { 
        position: fixed; 
        bottom: 15px; /* Separada del borde inferior */
        left: 10px; 
        right: 10px; 
        background: white; 
        display: flex; 
        gap: 8px; 
        padding: 8px; 
        border-radius: 30px; /* Bordes redondeados de c√°psula */
        box-shadow: 0 4px 15px rgba(0,0,0,0.15); /* Sombra para efecto flotante */
        z-index: 1000; 
    }

    #userInput { flex: 1; padding: 10px 18px; border: none; outline: none; font-size: 16px; background: transparent; }
    #sendButton { background: var(--accent-green); border: none; padding: 0 20px; border-radius: 25px; font-weight: bold; cursor: pointer; color: var(--primary-blue); }

    .form-card { background: #eef6fc; padding: 15px; border-radius: 12px; border-left: 4px solid var(--primary-blue); width: 100%; box-sizing: border-box; }
    a { color: var(--primary-blue); font-weight: bold; }
</style>
</head>
<body>
    <header>
        <div class="header-content">
            <img src="logo.jpg" alt="Logo" class="header-logo" onerror="this.style.display='none'">
            <div class="header-info"><h1>Portal RRHH Chascom√∫s</h1></div>
        </div>
        <button onclick="clearChat()" class="btn-logout">Salir</button>
    </header>

    <main id="chatMessages" class="chat-container"></main>

    <footer class="input-area">
        <input type="text" id="userInput" placeholder="Escribe aqu√≠..." autocomplete="off">
        <button id="sendButton">Enviar</button>
    </footer>

    <script>
        const WHATSAPP_RRHH = "5492241538198";
        const TEL_MEDICINA = "2241000000"; // Cambiar por el real

        const menus = {
            main: { id: 'main', title: '¬øQu√© tr√°mite deseas realizar?', options: [
                { id: 'recibos', label: 'üìÑ Recibos de Sueldo' },
                { id: 'licencias', label: 'üìù Licencias y Art√≠culos' },
                { id: 'medicina', label: 'üè• Medicina Laboral' },
                { id: 'faq', label: '‚ùì Preguntas Frecuentes' },
                { id: 'contacto', label: 'üë§ Hablar con un Operador', type: 'leaf', apiKey: 'contacto_humano' }
            ]},
            recibos: { id: 'recibos', parent: 'main', title: 'Recibos:', options: [
                { id: 'ir_intranet', label: 'üåê Entrar a la Intranet', type: 'leaf', apiKey: 'intranet_link' },
                { id: 'error_ingreso', label: 'üîë Ayuda Clave', type: 'leaf', apiKey: 'ayuda_clave' }
            ]},
            licencias: { id: 'licencias', parent: 'main', title: 'Selecciona el tipo:', options: [
                { id: 'form_vacaciones', label: 'üèñÔ∏è Vacaciones', type: 'form', formType: 'vacaciones' },
                { id: 'form_articulos', label: 'üìë Art√≠culos Especiales', type: 'form', formType: 'articulos' },
                { id: 'lic_info', label: '‚ÑπÔ∏è Informaci√≥n de Art√≠culos', type: 'leaf', apiKey: 'info_arts' }
            ]},
            medicina: { id: 'medicina', parent: 'main', title: 'Medicina Laboral:', options: [
                { id: 'horarios_med', label: '‚è∞ Horarios y Direcci√≥n', type: 'leaf', apiKey: 'med_info' }
            ]},
            faq: { id: 'faq', parent: 'main', title: 'Dudas frecuentes:', options: [
                { id: 'faq_vacas', label: 'üìÖ ¬øCu√°ntos d√≠as me corresponden?', type: 'leaf', apiKey: 'ans_vacas' },
                { id: 'faq_cert', label: '‚è±Ô∏è Plazo para certificados', type: 'leaf', apiKey: 'ans_cert' },
                { id: 'faq_art', label: 'üöë Accidente Laboral', type: 'leaf', apiKey: 'ans_art' },
                { id: 'faq_rec', label: 'üìÖ Fecha de Cobro', type: 'leaf', apiKey: 'ans_rec' }
            ]}
        };

        const responses = {
            'ans_vacas': `<strong>üìÖ Vacaciones seg√∫n Antig√ºedad:</strong><br><br>
                ‚Ä¢ <b>Menos de 5 a√±os:</b> 14 d√≠as corridos.<br>
                ‚Ä¢ <b>De 5 a 10 a√±os:</b> 21 d√≠as corridos.<br>
                ‚Ä¢ <b>De 10 a 20 a√±os:</b> 28 d√≠as corridos.<br>
                ‚Ä¢ <b>M√°s de 20 a√±os:</b> 35 d√≠as corridos.<br><br>
                <i>* La antig√ºedad se computa al 31 de diciembre.</i>`,

            'info_arts': `<strong>üìë Art√≠culos Disponibles:</strong><br><br>
                ‚Ä¢ <b>Art 1:</b> Asuntos Particulares.<br>
                ‚Ä¢ <b>Art 2:</b> Familiar Enfermo.<br>
                ‚Ä¢ <b>Art 3:</b> Donaci√≥n de Sangre.<br>
                ‚Ä¢ <b>Art 4:</b> Fallecimiento.<br>
                ‚Ä¢ <b>Art 5:</b> Cuidado de Hijo.<br>
                ‚Ä¢ <b>Maternidad:</b> Nacimiento.<br>
                ‚Ä¢ <b>Embarazo:</b> Pre-natal.<br>
                ‚Ä¢ <b>Accidente:</b> Laboral (ART).`,

            'med_info': `<strong>üè• Medicina Laboral (Centro C√≠vico)</strong><br><br>
                üìç Calle Dorrego esq. Bolivar.<br>
                üìû <a href="tel:${TEL_MEDICINA}">${TEL_MEDICINA}</a><br><br>
                üçé <b>Docentes:</b> Lun, Mar y Mi√©: 07:30 a 09:00 hs.<br><br>
                üíº <b>No Docentes:</b><br>
                ‚Ä¢ Lun: 14:00 a 16:30 hs.<br>
                ‚Ä¢ Mar y Jue: 09:00 a 11:00 hs.<br>
                ‚Ä¢ Mi√© y Vie: 10:00 a 12:30 hs.`,

            'intranet_link': `Acced√© a tus recibos aqu√≠:<br><br><a href="https://intranet.chascomus.gob.ar/" target="_blank">üëâ Ir a la Intranet</a>`,
            'ayuda_clave': `Si no record√°s tu clave, envi√° Nombre, Apellido y Legajo para resetear tu cuenta.`,
            'ans_cert': `Deben presentarse dentro de las <b>48 horas h√°biles</b> de la inasistencia.`,
            'ans_art': `1. Avisar al jefe. 2. Llamar a la ART. 3. Denunciar en RRHH antes de las 24hs.`,
            'ans_rec': `<b>Fecha de Cobro:</b> Habitualmente el 2do d√≠a h√°bil del mes. Extras entre el 15 y 20.`,
            'contacto_humano': `<a href="https://wa.me/${WHATSAPP_RRHH}">üëâ Chatear con RRHH</a>`
        };

        let userName = localStorage.getItem('hr_user_name') || "";
        let currentPath = ['main'];

        window.onload = () => {
            if (!userName) {
                addBotMessage("Bienvenido. Para comenzar, ingres√° tu <b>Nombre y N¬∫ de Legajo</b>:");
            } else {
                addBotMessage(`Hola de nuevo, <b>${userName}</b>.`);
                renderMenu();
            }
        };

        function processInput() {
            const input = document.getElementById('userInput');
            const val = input.value.trim();
            if (!val) return;
            addUserMessage(val);
            if (!userName) {
                if (val.length > 5 && /\d/.test(val)) {
                    userName = val;
                    localStorage.setItem('hr_user_name', userName);
                    addBotMessage("‚úÖ Registrado correctamente.");
                    renderMenu();
                } else {
                    addBotMessage("‚ùå Por favor, ingres√° Nombre y Legajo (Ej: Juan Perez 1234).");
                }
            }
            input.value = '';
        }

        function renderMenu() {
            const menu = menus[currentPath[currentPath.length - 1]];
            let opts = [...menu.options];
            if (currentPath.length > 1) opts.push({ id: 'back', label: '‚¨ÖÔ∏è Volver', type: 'nav' });
            addBotMessage(menu.title, true, opts);
        }

        function handleOption(id, label, type, apiKey, formType) {
            if (id === 'back') { currentPath = ['main']; renderMenu(); return; }
            addUserMessage(label);
            if (type === 'form') renderForm(formType);
            else if (type === 'leaf') { addBotMessage(responses[apiKey]); setTimeout(renderMenu, 1500); }
            else { currentPath.push(id); renderMenu(); }
        }

        function renderForm(type) {
            const formId = `f_${Date.now()}`;
            const isVaca = type === 'vacaciones';
            const html = `
                <div class="form-card" id="${formId}">
                    <strong>${isVaca ? 'üèñÔ∏è Solicitud Vacaciones' : 'üìë Licencia/Art√≠culos'}</strong>
                    <label>FECHA INICIO</label><input type="date" id="f_date">
                    <label>${isVaca ? 'CANTIDAD D√çAS' : 'SELECCIONAR TIPO'}</label>
                    ${isVaca ? 
                        '<input type="number" id="f_val" placeholder="Ej: 14">' : 
                        `<select id="f_val">
                            <option>Art 1 (Particulares)</option>
                            <option>Art 2 (Familiar Enfermo)</option>
                            <option>Art 3 (Donaci√≥n Sangre)</option>
                            <option>Art 4 (Fallecimiento)</option>
                            <option>Art 5 (Cuidado de Hijo)</option>
                            <option>Maternidad / Embarazo</option>
                            <option>Accidente Laboral (ART)</option>
                        </select>`}
                    <div class="form-actions">
                        <button class="btn-submit" onclick="submitForm('${type}','${formId}')">ENVIAR</button>
                        <button class="btn-cancel" onclick="cancelForm('${formId}')">CANCELAR</button>
                    </div>
                </div>`;
            addBotMessage("Por favor, complet√° los datos:");
            const div = document.createElement('div');
            div.innerHTML = html;
            document.getElementById('chatMessages').appendChild(div);
            scrollChat();
        }

        function cancelForm(id) { 
            document.getElementById(id).innerHTML = "<small><i>‚ùå Formulario cancelado.</i></small>"; 
            setTimeout(renderMenu, 1000); 
        }

        function submitForm(type, formId) {
            const container = document.getElementById(formId);
            const date = container.querySelector('#f_date').value;
            const val = container.querySelector('#f_val').value;
            if(!date || !val) return alert("Faltan completar datos");
            const text = `*SOLICITUD RRHH*\nEmpleado: ${userName}\nTr√°mite: ${type}\nFecha Inicio: ${date}\nDetalle/D√≠as: ${val}`;
            window.open(`https://wa.me/${WHATSAPP_RRHH}?text=${encodeURIComponent(text)}`, '_blank');
            container.innerHTML = "<b>‚úÖ Solicitud enviada.</b>";
            setTimeout(renderMenu, 2000);
        }

        function addBotMessage(t, s, o) {
            const row = document.createElement('div');
            row.className = 'message-row';
            let h = `<div class="message bot">${t}</div>`;
            if (o) {
                h += `<div class="options-container">`;
                o.forEach(opt => { h += `<button class="option-button" onclick="handleOption('${opt.id}','${opt.label}','${opt.type}','${opt.apiKey}','${opt.formType}')">${opt.label}</button>`; });
                h += `</div>`;
            }
            row.innerHTML = h;
            document.getElementById('chatMessages').appendChild(row);
            scrollChat();
        }

        function addUserMessage(t) {
            const row = document.createElement('div');
            row.className = 'message-row';
            row.innerHTML = `<div class="message user">${t}</div>`;
            document.getElementById('chatMessages').appendChild(row);
            scrollChat();
        }

        function scrollChat() { 
            const c = document.getElementById('chatMessages'); 
            c.scrollTop = c.scrollHeight; 
        }
        
        function clearChat() { 
            if(confirm("¬øCerrar sesi√≥n y salir?")) { 
                localStorage.clear(); 
                location.reload(); 
            } 
        }

        document.getElementById('sendButton').onclick = processInput;
        document.getElementById('userInput').onkeypress = (e) => { if(e.key === 'Enter') processInput(); };
    </script>
</body>
</html>
